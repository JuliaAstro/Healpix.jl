# import Healpix
# using Test

## spin 0 map2alm
nside = 4
lmax = 4
map = Healpix.Map{Float64, Healpix.RingOrder}(2 .* ones(Healpix.nside2npix(nside)))
alm = Healpix.map2alm(map, lmax, lmax)

test_alm_spin0 = [
    7.08981540e+00,  6.26606889e-17, -4.64452418e-02, -1.43573675e-16,
    -1.10275269e-01,  0.00000000e+00, 0.00000000e+00,  0.00000000e+00,
    0.00000000e+00,  0.00000000e+00, 0.00000000e+00,  0.00000000e+00,
    0.00000000e+00,  0.00000000e+00, -7.87873039e-04-9.64866195e-20im]
@test isapprox(alm.alm , test_alm_spin0)

## spin 0 alm2map
nside = 2
lmax = 2
nalms = Healpix.numberOfAlms(lmax, lmax)
alm = Healpix.Alm{ComplexF64}(lmax, lmax, 2 .* ones(ComplexF64, nalms))
map = Healpix.alm2map(alm, nside)

test_map_spin0 = [
        1.22822792,  3.61032581,  3.61032581,  1.22822792, -0.33740788,
       -0.16286106,  1.80075965,  4.40319186,  4.40319186,  1.80075965,
       -0.16286106, -0.33740788, -0.4312723 , -1.13862492, -0.90401688,
        2.07742993,  4.11691608,  2.07742993, -0.90401688, -1.13862492,
       -0.25082501, -1.68800153, -0.63028243,  2.30273478,  2.30273478,
       -0.63028243, -1.68800153, -0.25082501,  0.859566  , -0.41667555,
       -1.5554869 ,  0.05254053,  1.52313774,  0.05254053, -1.5554869 ,
       -0.41667555,  1.19694074, -0.29055765, -0.67742383,  0.26296318,
        0.26296318, -0.67742383, -0.29055765,  1.19694074,  1.03769816,
        0.21777049,  0.21777049,  1.03769816]
@test isapprox(map.pixels, test_map_spin0)

##